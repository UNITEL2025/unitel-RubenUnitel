<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FAQ</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        function search(str) {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var result = JSON.parse(this.responseText);

                    if (result["status"] == 0) {
                        //Mostrar el alert de danger
                        document.getElementById("alert_danger").removeAttribute("hidden");
                    }
                    else if (result["status"] == 1) {
                        //Todo es correcto -> cargamos el acordeón
                        document.getElementById("faqContenedor").innerHTML = result["html"];
                    }
                    else if (result["status"] == 2) {
                        //No hemos encontrado datos y hay que mostrar el alert de info
                        document.getElementById("alert_info").removeAttribute("hidden");
                    }
                    
                    
                }
            };
            xmlhttp.open("GET", "controller.php?q=" + str, true);
            xmlhttp.send();
        }
        function showError() {
            
            //Si tiene la clase btn-danger hay que quitarla y poner la clase btb-success
            if (document.getElementById("error_btn").classList.contains("btn-danger"))
            {
                document.getElementById("error_btn").classList.remove("btn-danger"); 
                document.getElementById("error_btn").classList.add("btn-success");
                document.getElementById("error_btn").innerHTML = "Ocultar error";
                document.getElementById("alert_danger").removeAttribute("hidden");
            }
            else {
                document.getElementById("alert_danger").setAttribute("hidden", '');
                document.getElementById("error_btn").classList.remove("btn-success"); 
                document.getElementById("error_btn").classList.add("btn-danger");
                document.getElementById("error_btn").innerHTML = "Mostrar error";
            }
        }
    </script>
</head>

<body class="p-4">
    
    <div class="container" style="max-width: 600px; margin-top: 50px;">
        <!-- Alerta Danger -->
        <div class="alert alert-danger" role="alert" id="alert_danger" hidden>
            Error! No se pudo conectar con la Base de Datos.
        </div>

        <!-- Input de texto -->
        <div class="mb-4">
            <input type="text" class="form-control" placeholder="Escribe tu pregunta aquí..." onkeyup="search(this.value);">
        </div>

        <!-- Alerta Info -->
        <div class="alert alert-info" role="alert" id="alert_info" hidden>
            Revisa las preguntas frecuentes antes de contactar con soporte.
        </div>

        <!-- Acordeón -->
         <div id="faqContenedor"></div>

        <!-- Botón danger -->
        <div class="text-end">
            <button id="error_btn" class="btn btn-danger" onclick="showError();">Mostrar Error</button>
        </div>
    </div>

    <!-- Bootstrap JS (necesario para el acordeón) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>